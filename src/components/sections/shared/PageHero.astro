---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";
import electricImage from "../../../assets/images/hero_image.jpg";
import Button from "../../ui/Button.astro";

interface Cta {
  label: string;
  href: string;
}

interface BentoCard {
  title: string;
  description: string;
  value?: string;
}

interface Props {
  id?: string;
  slot?: string;
  eyebrow?: string;
  title?: string;
  titleHtml?: string;
  description?: string;
  primaryCta?: Cta;
  secondaryCta?: Cta;
  bentoCards?: BentoCard[];
  backgroundImage?: ImageMetadata;
  backgroundImageAlt?: string;
}

const {
  id = "modern-page-hero-bento",
  slot,
  eyebrow,
  title,
  titleHtml,
  description,
  primaryCta,
  secondaryCta,
  bentoCards = [],
  backgroundImage = electricImage,
  backgroundImageAlt = "Vnitřek elektrického rozvaděče s vodiči",
} = Astro.props;

const resolvedBentoCards =
  bentoCards.length > 0
    ? bentoCards
    : [
        {
          title: "Odborné montáže",
          description:
            "Kompletní elektroinstalace pro rodinné domy, byty i komerční prostory.",
          value: "Praxe",
        },
        {
          title: "Revize",
          description:
            "Zajišťujeme veškerou dokumentaci a revizní zprávy v souladu s normami ČSN.",
          value: "ČSN",
        },
        {
          title: "Individuální přístup",
          description:
            "Návrh optimálního řešení na míru vašim konkrétním potřebám.",
        },
      ];

const [cardOne, cardTwo, cardThree] = [
  resolvedBentoCards[0] ?? {
    title: "Odborné montáže",
    description: "Kompletní elektroinstalace a montáže.",
    value: "Praxe",
  },
  resolvedBentoCards[1] ?? {
    title: "Kvalitní materiály",
    description: "Prověřené komponenty od předních výrobců.",
    value: "Kvalita",
  },
  resolvedBentoCards[2] ?? {
    title: "Platné revize",
    description: "Revizní zprávy dle norem ČSN.",
    value: "ČSN",
  },
];
---

<section
  slot={slot}
  id={id}
  class="relative isolate overflow-hidden bg-neutral-800/95 py-32 lg:py-64"
>
  <div class="absolute inset-0">
    <Image
      src={backgroundImage}
      alt={backgroundImageAlt}
      widths={[640, 1024, 1280, 1920]}
      sizes="100vw"
      class="h-full w-full object-cover object-center"
      loading="eager"
      fetchpriority="high"
      quality={80}
    />
  </div>

  <div
    class="absolute inset-0 bg-gradient-to-r from-neutral-800/95 via-neutral-800/80 to-neutral-800/95"
  >
  </div>
  <div
    class="absolute inset-0 bg-gradient-to-b from-neutral-800/55 via-transparent to-neutral-800/80"
  >
  </div>
  <div class="absolute inset-0 bg-neutral-800/40"></div>
  <div
    class="mask-image-gradient bg-grid-pattern-dark absolute inset-0 opacity-20"
  >
  </div>

  <div class="relative z-10 mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="grid items-center gap-16 lg:grid-cols-2">
      <div class="flex flex-col space-y-8">
        {
          eyebrow ? (
            <p class="animate-fade-up border-accent-primary/70 text-accent-primary/70 mb-10 w-fit rounded border px-3 py-2 text-xs font-bold tracking-widest uppercase">
              {eyebrow}
            </p>
          ) : null
        }

        {
          titleHtml ? (
            <h1
              class="animate-fade-up animate-delay-100 font-sora mt-4 text-4xl font-semibold text-neutral-50 sm:text-5xl xl:text-6xl"
              set:html={titleHtml}
            />
          ) : title ? (
            <h1 class="animate-fade-up animate-delay-100 font-sora mt-4 text-4xl font-semibold text-neutral-50 sm:text-5xl lg:text-6xl">
              {title}
            </h1>
          ) : null
        }

        {
          description ? (
            <p class="animate-fade-up animate-delay-200 mt-4 text-base leading-relaxed text-neutral-300 sm:text-lg">
              {description}
            </p>
          ) : null
        }

        {
          primaryCta || secondaryCta ? (
            <div class="animate-fade-up animate-delay-300 mt-6 flex flex-col gap-4 sm:flex-row sm:items-center">
              {primaryCta ? (
                <Button variant="primaryDark" href={primaryCta.href} size="md">
                  {primaryCta.label}
                </Button>
              ) : null}
              {secondaryCta ? (
                <Button
                  variant="secondaryOutline"
                  href={secondaryCta.href}
                  class="hidden sm:inline-flex"
                  size="md"
                >
                  {secondaryCta.label}
                </Button>
              ) : null}
            </div>
          ) : null
        }
      </div>

      <div
        class="relative flex aspect-[4/3] w-full items-center lg:aspect-auto lg:h-[600px]"
      >
        <div class="relative w-full">
          <div class="absolute -inset-4 rounded-lg"></div>

          <div class="relative z-10 sm:p-5">
            <div class="grid grid-cols-1 gap-3 sm:gap-4 lg:grid-cols-4">
              {
                [cardOne, cardTwo, cardThree].map((card, index) => (
                  <article
                    class:list={[
                      "animate-fade-up rounded-lg border border-neutral-700/40 bg-neutral-800/95 p-4 shadow-2xl sm:p-5",
                      index === 0
                        ? "animate-delay-200 lg:col-start-2 lg:-col-end-1 lg:row-start-1"
                        : "",
                      index === 1
                        ? "animate-delay-300 lg:col-start-1 lg:col-end-4 lg:row-start-2"
                        : "",
                      index === 2
                        ? "animate-delay-400 lg:col-start-2 lg:-col-end-1 lg:row-start-3"
                        : "",
                    ]}
                  >
                    <p class="text-accent-primary/80 text-[11px] font-bold tracking-[0.2em] uppercase">
                      {card.value ?? "Služba"}
                    </p>
                    <h3 class="mt-3 text-sm font-semibold tracking-wide text-neutral-50 uppercase sm:text-base">
                      {card.title}
                    </h3>
                    <p class="mt-2 text-xs leading-relaxed text-neutral-300 sm:text-sm">
                      {card.description}
                    </p>
                  </article>
                ))
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
